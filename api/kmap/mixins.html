<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mixins | KDK</title>
    <meta name="description" content="The Kalisio Development Kit">
    <link rel="icon" href="https://s3.eu-central-1.amazonaws.com/kalisioscope/kdk/kdk-icon-64x64.png">
  <link rel="manifest" href="/kdk/manifest.json">
    
    <link rel="preload" href="/kdk/assets/css/0.styles.c934418d.css" as="style"><link rel="preload" href="/kdk/assets/js/app.036b59a9.js" as="script"><link rel="preload" href="/kdk/assets/js/7.68a9ee17.js" as="script"><link rel="prefetch" href="/kdk/assets/js/10.f14beb46.js"><link rel="prefetch" href="/kdk/assets/js/11.c0941532.js"><link rel="prefetch" href="/kdk/assets/js/12.8121ba0d.js"><link rel="prefetch" href="/kdk/assets/js/13.a8b20649.js"><link rel="prefetch" href="/kdk/assets/js/14.542b5fe8.js"><link rel="prefetch" href="/kdk/assets/js/15.d6304989.js"><link rel="prefetch" href="/kdk/assets/js/16.061be687.js"><link rel="prefetch" href="/kdk/assets/js/17.0a281666.js"><link rel="prefetch" href="/kdk/assets/js/18.bf3cbe21.js"><link rel="prefetch" href="/kdk/assets/js/19.26ec3968.js"><link rel="prefetch" href="/kdk/assets/js/2.573e0480.js"><link rel="prefetch" href="/kdk/assets/js/20.5bebf779.js"><link rel="prefetch" href="/kdk/assets/js/21.2579d0de.js"><link rel="prefetch" href="/kdk/assets/js/22.93a052de.js"><link rel="prefetch" href="/kdk/assets/js/23.0eaf9b2a.js"><link rel="prefetch" href="/kdk/assets/js/24.7d1e1501.js"><link rel="prefetch" href="/kdk/assets/js/25.bf21b839.js"><link rel="prefetch" href="/kdk/assets/js/26.9cb19cbd.js"><link rel="prefetch" href="/kdk/assets/js/27.7a5f043a.js"><link rel="prefetch" href="/kdk/assets/js/28.594a986d.js"><link rel="prefetch" href="/kdk/assets/js/29.367b31e0.js"><link rel="prefetch" href="/kdk/assets/js/3.20e6e5d0.js"><link rel="prefetch" href="/kdk/assets/js/30.b2fbd80c.js"><link rel="prefetch" href="/kdk/assets/js/31.98f792ad.js"><link rel="prefetch" href="/kdk/assets/js/32.06808ac8.js"><link rel="prefetch" href="/kdk/assets/js/33.a058bb8f.js"><link rel="prefetch" href="/kdk/assets/js/34.259db616.js"><link rel="prefetch" href="/kdk/assets/js/35.ef0d09eb.js"><link rel="prefetch" href="/kdk/assets/js/36.cb983da3.js"><link rel="prefetch" href="/kdk/assets/js/37.1e7976a6.js"><link rel="prefetch" href="/kdk/assets/js/38.d1362478.js"><link rel="prefetch" href="/kdk/assets/js/39.62e266c8.js"><link rel="prefetch" href="/kdk/assets/js/4.771347c2.js"><link rel="prefetch" href="/kdk/assets/js/40.c2eb2d10.js"><link rel="prefetch" href="/kdk/assets/js/41.284d42b6.js"><link rel="prefetch" href="/kdk/assets/js/42.5e928a4c.js"><link rel="prefetch" href="/kdk/assets/js/43.566f530e.js"><link rel="prefetch" href="/kdk/assets/js/44.a11d5088.js"><link rel="prefetch" href="/kdk/assets/js/45.58956323.js"><link rel="prefetch" href="/kdk/assets/js/46.2d3e08b4.js"><link rel="prefetch" href="/kdk/assets/js/47.348677e0.js"><link rel="prefetch" href="/kdk/assets/js/48.42c94536.js"><link rel="prefetch" href="/kdk/assets/js/49.0e0a40c2.js"><link rel="prefetch" href="/kdk/assets/js/5.3dc9ed43.js"><link rel="prefetch" href="/kdk/assets/js/50.8a6de062.js"><link rel="prefetch" href="/kdk/assets/js/51.ab30d3ed.js"><link rel="prefetch" href="/kdk/assets/js/52.eb133ec0.js"><link rel="prefetch" href="/kdk/assets/js/53.ce7acb8f.js"><link rel="prefetch" href="/kdk/assets/js/54.f74fa9e0.js"><link rel="prefetch" href="/kdk/assets/js/55.41c70bee.js"><link rel="prefetch" href="/kdk/assets/js/56.16c35b89.js"><link rel="prefetch" href="/kdk/assets/js/57.8fcbeaec.js"><link rel="prefetch" href="/kdk/assets/js/58.13245bf7.js"><link rel="prefetch" href="/kdk/assets/js/59.eeca0ab5.js"><link rel="prefetch" href="/kdk/assets/js/6.709eff07.js"><link rel="prefetch" href="/kdk/assets/js/60.4d03f33a.js"><link rel="prefetch" href="/kdk/assets/js/8.e12a9c2d.js"><link rel="prefetch" href="/kdk/assets/js/9.acf6b4e8.js">
    <link rel="stylesheet" href="/kdk/assets/css/0.styles.c934418d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/kdk/" class="home-link router-link-active"><!----> <span class="site-name">KDK</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/kdk/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/kdk/guides/" class="nav-link">Guides</a></div><div class="nav-item"><a href="/kdk/architecture/" class="nav-link">Architecture</a></div><div class="nav-item"><a href="/kdk/api/" class="nav-link router-link-active">API</a></div><div class="nav-item"><a href="/kdk/tips.html" class="nav-link">Tips</a></div><div class="nav-item"><a href="/kdk/tools/" class="nav-link">Tools</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/kdk/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/kdk/guides/" class="nav-link">Guides</a></div><div class="nav-item"><a href="/kdk/architecture/" class="nav-link">Architecture</a></div><div class="nav-item"><a href="/kdk/api/" class="nav-link router-link-active">API</a></div><div class="nav-item"><a href="/kdk/tips.html" class="nav-link">Tips</a></div><div class="nav-item"><a href="/kdk/tools/" class="nav-link">Tools</a></div> <!----></nav> <p align="center"><a href="https://kalisio.com"><img src="https://s3.eu-central-1.amazonaws.com/kalisioscope/kalisio/kalisio-logo-black-256x84.png"></a> <br> <i><small>Unleashing the potential of spatial information</small></i></p> <ul class="sidebar-links"><li><a href="/kdk/api/" class="sidebar-link">API</a></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>kCore</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>kMap</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/kdk/api/kmap/" class="sidebar-link">Overview</a></li><li><a href="/kdk/api/kmap/services.html" class="sidebar-link">Services</a></li><li><a href="/kdk/api/kmap/hooks.html" class="sidebar-link">Hooks</a></li><li><a href="/kdk/api/kmap/components.html" class="sidebar-link">Components</a></li><li><a href="/kdk/api/kmap/mixins.html" class="active sidebar-link">Mixins</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kdk/api/kmap/mixins.html#geolocation" class="sidebar-link">Geolocation</a></li><li class="sidebar-sub-header"><a href="/kdk/api/kmap/mixins.html#navigator" class="sidebar-link">Navigator</a></li><li class="sidebar-sub-header"><a href="/kdk/api/kmap/mixins.html#time" class="sidebar-link">Time</a></li><li class="sidebar-sub-header"><a href="/kdk/api/kmap/mixins.html#feature-service" class="sidebar-link">Feature Service</a></li><li class="sidebar-sub-header"><a href="/kdk/api/kmap/mixins.html#weacast" class="sidebar-link">Weacast</a></li><li class="sidebar-sub-header"><a href="/kdk/api/kmap/mixins.html#activity" class="sidebar-link">Activity</a></li><li class="sidebar-sub-header"><a href="/kdk/api/kmap/mixins.html#location-indicator" class="sidebar-link">Location indicator</a></li><li class="sidebar-sub-header"><a href="/kdk/api/kmap/mixins.html#map" class="sidebar-link">Map</a></li><li class="sidebar-sub-header"><a href="/kdk/api/kmap/mixins.html#globe" class="sidebar-link">Globe</a></li></ul></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>kTeam</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>kNotify</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>kBilling</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>kEvent</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>kano</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="mixins"><a href="#mixins" aria-hidden="true" class="header-anchor">#</a> Mixins</h1> <h2 id="geolocation"><a href="#geolocation" aria-hidden="true" class="header-anchor">#</a> Geolocation</h2> <p>Make your component automatically retrieve the user's location on initialization or when he has logged in (the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API" target="_blank" rel="noopener noreferrer">Geolocation API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is used under-the-hood):</p> <ul><li><strong>updatePosition()</strong> launches a geolocation</li></ul> <blockquote><p>Will make the position available in the <code>user.position</code> property of the currently authenticated user in the <a href="/kdk/api/kcore/application.html#store">global store</a>.</p></blockquote> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Will raise an error toast on geolocation error</p></div> <h2 id="navigator"><a href="#navigator" aria-hidden="true" class="header-anchor">#</a> Navigator</h2> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>Only available on mobile devices</p></div> <p>Allow to launch native route navigation apps to go to a given location (the <a href="https://github.com/dpa99c/phonegap-launch-navigator" target="_blank" rel="noopener noreferrer">launch navigator cordova plugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is used under-the-hood):</p> <ul><li><strong>canNavigate()</strong> check if navigation is possible (mobile device and navigation app installed)</li> <li><strong>navigate(longitude, latitude)</strong> launches native route navigation app for the given location</li></ul> <h2 id="time"><a href="#time" aria-hidden="true" class="header-anchor">#</a> Time</h2> <p>Ease management of time-based component:</p> <ul><li><strong>setCurrentTime(datetime)</strong> change the current time to the given one and ensure it is internally stored as a UTC <a href="https://momentjs.com/" target="_blank" rel="noopener noreferrer">moment<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> object to avoid any confusion</li> <li><strong>setTimeFormat(format)</strong> change the formats used to display date/time, each format is based on <a href="https://momentjs.com/docs/#/displaying/format/" target="_blank" rel="noopener noreferrer">moment<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> display options and the object is structured like this
<ul><li><strong>time</strong> <ul><li><strong>short</strong>: display format for time in &quot;short&quot; form</li> <li><strong>long</strong>: display format for time in &quot;long&quot; form</li></ul></li> <li><strong>date</strong> <ul><li><strong>short</strong>: display format for date in &quot;short&quot; form</li> <li><strong>long</strong>: display format for date in &quot;long&quot; form</li></ul></li> <li><strong>year</strong> <ul><li><strong>short</strong>: display format for year in &quot;short&quot; form</li> <li><strong>long</strong>: display format for year in &quot;long&quot; form</li></ul></li> <li><strong>utc</strong>: boolean indicating if date/time should be displayed in UTC or according to user's locale</li> <li><strong>locale</strong>: the user's locale to be used when not displaying date/time in UTC</li></ul></li> <li><strong>formatTime(format, datetime)</strong>: get the formatted date/time for display according to current format settings, if no date/time given the current one set in component will be used. The format is the path to the actual format in the format object, e.g. <code>formatTime('time.short')</code> to get a formatted time in short form. The <code>iso</code> path is reserved for <a href="https://en.wikipedia.org/wiki/ISO_8601" target="_blank" rel="noopener noreferrer">ISO 8601<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> display.</li></ul> <p>Here is an example of a format object:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  time<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    short<span class="token punctuation">:</span> <span class="token string">'H[h]'</span><span class="token punctuation">,</span>
    long<span class="token punctuation">:</span> <span class="token string">'HH:mm'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  date<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    short<span class="token punctuation">:</span> <span class="token string">'DD/MM'</span><span class="token punctuation">,</span>
    long<span class="token punctuation">:</span> <span class="token string">'dddd D'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  year<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    short<span class="token punctuation">:</span> <span class="token string">'YY'</span><span class="token punctuation">,</span>
    long<span class="token punctuation">:</span> <span class="token string">'YYYY'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  utc<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  locale<span class="token punctuation">:</span> <span class="token string">'en'</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>The mixin is in sync with the <code>timeFormat</code> property of the <a href="/kdk/api/kcore/application.html#store">global store</a> so that you can have a shared data/time display format accross all time-based components with a dedicated UI to change settings using e.g. <code>store.patch('timeFormat', { locale, utc })</code>.</p></div> <p>This mixin also adds the following internal data properties:</p> <ul><li><strong>currentTime</strong>: current time as UTC <a href="https://momentjs.com/" target="_blank" rel="noopener noreferrer">moment<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> object</li> <li><strong>currentTimeFormat</strong>: current format object to be used for display</li> <li><strong>currentFormattedTime</strong>: same structure as the format object but contains ready-to-display values of the current time, e.g. <code>currentFormattedTime.time.short</code> will give you the formatted time string in short form according to current format settings.</li></ul> <h2 id="feature-service"><a href="#feature-service" aria-hidden="true" class="header-anchor">#</a> Feature Service</h2> <p>Ease requests to a <a href="/kdk/api/kmap/services.html#feature-service">feature service</a> in order to get real-time updates:</p> <ul><li><strong>getProbeFeatures(options)</strong> retrieve the probe locations (if any) for a given <a href="/kdk/api/kmap/services.html#catalog">catalog layer descriptor</a> to initialize the feature layer</li> <li><strong>getProbeFeaturesFromLayer(name)</strong> same as above but using the layer name</li> <li><strong>getFeatures(options, queryInterval)</strong> get the latest available features for a given <a href="/kdk/api/kmap/services.html#catalog">catalog layer descriptor</a> at current time or in a given elapsed time range if a query interval in milliseconds is given</li> <li><strong>getFeaturesFromLayer(name, queryInterval)</strong> same as above but using the layer name</li> <li><strong>getMeasureForFeature(options, feature, startTime, endTime)</strong> get the available probe measures for a given <a href="/kdk/api/kmap/services.html#catalog">catalog layer descriptor</a> in the given time range, will store result in <code>probedLocation</code> attribute</li> <li><strong>getProbedLocationMeasureAtCurrentTime()</strong> computes measure values at current time (see <a href="/kdk/api/kmap/mixins.html#time">time mixin</a>) once a location has been probed</li></ul> <p>Please refer to <a href="/kdk/api/kmap/services.html#time-based-feature-aggregation">feature service API</a> for more details.</p> <h2 id="weacast"><a href="#weacast" aria-hidden="true" class="header-anchor">#</a> Weacast</h2> <p>Make it easier to integrate with <a href="https://weacast.github.io/weacast-docs/" target="_blank" rel="noopener noreferrer">Weacast<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</p> <ul><li><strong>setupWeacast(config)</strong> initializes a <a href="https://weacast.github.io/weacast-docs/api/application.html#client-setup" target="_blank" rel="noopener noreferrer">Weacast client<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in the <code>weacastApi</code> property</li> <li><strong>setupForecastModels()</strong> retrieve available <a href="https://github.com/mapbox/simplestyle-spec" target="_blank" rel="noopener noreferrer">forecast models<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> from <a href="https://weacast.github.io/weacast-docs/api/forecast.html" target="_blank" rel="noopener noreferrer">Weacast API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><strong>getForecastForLocation(long, lat, startTime, endTime)</strong> helper function to dynamically probe weather elements at a given location in a given time range using the <a href="https://weacast.github.io/weacast-docs/api/probe.html#probes-api" target="_blank" rel="noopener noreferrer">Weacast API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><strong>getForecastForFeature(featureId, startTime, endTime)</strong> helper function to get weather element at static probe location in a given time range using the <a href="https://weacast.github.io/weacast-docs/api/probe.html#probe-results-api" target="_blank" rel="noopener noreferrer">Weacast API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><strong>getProbedLocationForecastAtCurrentTime()</strong> computes element values at current time (see <a href="/kdk/api/kmap/mixins.html#time">time mixin</a>) once a location has been probed (dynamically or statically)</li> <li><strong>getProbedLocationForecastMarker(feature, latlng)</strong> generates a marker using a <a href="http://weather.rap.ucar.edu/info/about_windbarb.html" target="_blank" rel="noopener noreferrer">wind barb<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> according to element values in feature</li></ul> <h2 id="activity"><a href="#activity" aria-hidden="true" class="header-anchor">#</a> Activity</h2> <p>Make it easier to create 2D/3D mapping activities:</p> <ul><li><strong>setMappingEngine(engine)</strong> setup the mapping engine to be used by activity (either <code>leaflet</code> for 2D mapping or <code>cesium</code> for 3D mapping), <strong>should be called first before any other method</strong></li> <li><strong>registerActivityActions()</strong> register default activity actions (fullscreen mode, geolocation, geocoding, tracking, probing, etc.)</li> <li><strong>getCatalogLayers()</strong> retrieve available <a href="/kdk/api/kmap/services.html#catalog">catalog layer descriptors</a></li> <li><strong>refreshLayers()</strong> setup available layers based on <a href="/kdk/api/kmap/services.html#catalog">catalog layer descriptors</a></li> <li><strong>isLayerStorable/Removable/Editable(layer)</strong> helper function to get the state of a given layer descriptor</li> <li><strong>onLayerAdded(layer)</strong> add layer action handler that will setup available action on layer</li> <li><strong>onTriggerLayer(layer)</strong> trigger layer action handler that will hide/show a given layer</li> <li><strong>onZoomToLayer(layer)</strong> zoom layer action handler that will zoom to a given layer</li> <li><strong>onCreateLayer()</strong> create layer action handler that will open an <a href="/kdk/api/kcore/components.html#editors">editor</a> to define layer properties</li> <li><strong>onSaveLayer(layer)</strong> save layer action handler that will persist a given in-memory layer to persistent storage provided by a <a href="/kdk/api/kmap/services.html#feature-service">feature service</a></li> <li><strong>onEditLayer(layer)</strong> edit layer action handler that will open an <a href="/kdk/api/kcore/components.html#editors">editor</a> to change layer properties</li> <li><strong>onRemoveLayer(layer)</strong> remove layer action handler that will ask for confirmation before removing a persisted layer</li> <li><strong>onGeocoding()</strong> geocoding action handler that will open a dialog to search for a location to go to</li> <li><strong>onGeolocate()</strong> geolocation action handler that will launch a user's position lookup and go to found user's location</li> <li><strong>onTrackLocation()</strong> location tracking action handler that will enable/disable a location indicator to display location values</li> <li><strong>storeView()</strong> store current view bounds as query parameters and persists as well in local storage</li> <li><strong>restoreView()</strong> restore previously stored view bounds from local storage or query parameters</li> <li><strong>clearStoredView()</strong> clears the stored view bounds so that it will not be restored anymore</li></ul> <h2 id="location-indicator"><a href="#location-indicator" aria-hidden="true" class="header-anchor">#</a> Location indicator</h2> <p>Allow to display an indicator on top of the map indicating the current mouse location:</p> <ul><li><strong>createLocationIndicator()</strong> installs the indicator</li> <li><strong>removeLocationIndicator()</strong> removes the indicator</li></ul> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>The mixin is in sync with the <code>locationFormat</code> property of the <a href="/kdk/api/kcore/application.html#store">global store</a> so that you can have a shared location display format accross all mapping components with a dedicated UI to change settings using e.g. <code>store.patch('locationFormat', 'FFf')</code>.</p></div> <p>This mixin also adds the following internal data properties:</p> <ul><li><strong>currentLocation</strong>: current location as [latitude, longitude]</li> <li><strong>currentLocationFormat</strong>: current location format object to be used for display as supported by <a href="https://github.com/nerik/formatcoords" target="_blank" rel="noopener noreferrer">formatcoords<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="map"><a href="#map" aria-hidden="true" class="header-anchor">#</a> Map</h2> <p>The underlying map object is based on <a href="http://leafletjs.com/" target="_blank" rel="noopener noreferrer">Leaflet<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and some mixins also rely on <a href="https://leafletjs.com/plugins.html" target="_blank" rel="noopener noreferrer">Leaflet plugins<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. The following set of mixins is to be used to construct a new map activity and underlying Leaflet objects.</p> <h3 id="base-map"><a href="#base-map" aria-hidden="true" class="header-anchor">#</a> Base Map</h3> <div class="danger custom-block"><p class="custom-block-title">WARNING</p> <p>This mixin is a mandatory one to build a map activity</p></div> <p>Make it possible to manage map layers and extend supported layer types:</p> <ul><li><strong>setupMap(domElement, options)</strong> creates the underlying Leaflet map object with given options</li> <li><strong>addLayer(options)/removeLayer(name)</strong> registers/destroys a layer based on a <a href="/kdk/api/kmap/services.html#catalog">catalog layer descriptor</a></li> <li><strong>showLayer/hideLayer(name)</strong> (un)hides the given layer in map, on first show the layer will be lazily created</li> <li><strong>hasLayer(name)</strong> check if a given layer is already registered</li> <li><strong>isLayerVisible(name)</strong> check if a given layer is visible and underlying Leaflet object created</li> <li><strong>zoomToLayer(name)</strong> fits the map view to visualize a given layer</li> <li><strong>zoomToBounds(bounds)</strong> fits the map view to visualize a given extent as bounds [ [south, west], [north, east] ]</li> <li><strong>getLayerByName(name)</strong> retrieve the <a href="/kdk/api/kmap/services.html#catalog">catalog layer descriptor</a> for a given layer</li> <li><strong>getLeafletLayerByName(name)</strong> retrieve the underlying Leaflet object for a given layer</li> <li><strong>createLeafletLayer(options)</strong> creates the underlying Leaflet object based on a <a href="/kdk/api/kmap/services.html#catalog">catalog layer descriptor</a>, will check all registered constructor for any one matching</li> <li><strong>registerLeafletConstructor(constructor)</strong> registers a Leaflet constructor function for a given type of layer</li> <li><strong>center(longitude, latitude, zoomLevel)</strong> centers the map view to visualize a given point at a given zoom level</li> <li><strong>getCenter()</strong> get the current map view center as longitude, latitude and zoom level</li> <li><strong>setCurrentTime(datetime)</strong> sets the current time to be used for time-based visualisation (e.g. weather forecast data or dynamic features)</li></ul> <p>This mixin automatically includes some Leaflet plugins: <a href="https://github.com/danwild/leaflet-fa-markers" target="_blank" rel="noopener noreferrer">leaflet-fa-markers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to create markers using Font Awesome icons, <a href="https://github.com/Leaflet/Leaflet.fullscreen" target="_blank" rel="noopener noreferrer">Leaflet.fullscreen<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to manage fullscreen mode, <a href="https://github.com/Leaflet/Leaflet.markercluster" target="_blank" rel="noopener noreferrer">Leaflet.markercluster<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to create marker clusters, <a href="https://github.com/Leaflet/Leaflet.VectorGrid" target="_blank" rel="noopener noreferrer">Leaflet.VectorGrid<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to display <a href="https://github.com/mapbox/vector-tile-spec" target="_blank" rel="noopener noreferrer">vector tiles<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h4 id="managing-panes"><a href="#managing-panes" aria-hidden="true" class="header-anchor">#</a> Managing panes</h4> <p>Although DOM-based layers like <a href="https://leafletjs.com/reference.html#marker" target="_blank" rel="noopener noreferrer">Markers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> could make use of a <code>z-index</code> to possibly manage render order between them, SVG or canvas-based layers used to manage <a href="https://leafletjs.com/reference.html#geojson" target="_blank" rel="noopener noreferrer">GeoJson features<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> like <a href="https://leafletjs.com/reference.html#polyline" target="_blank" rel="noopener noreferrer">Polylines<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> provided no mean to do so. Similarly, there was no simple way to render some layers only at some specific zoom levels. This is the reason why Leaflet 1.0 introduced the concept of <a href="https://leafletjs.com/reference.html#map-pane" target="_blank" rel="noopener noreferrer">panes<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>If you add a <code>zIndex</code> option to your layer descriptor we will create a dedicated pane for you under-the-hood so that the layer will be rendered at its right rank. Check the <code>z-index</code> value of <a href="https://leafletjs.com/reference.html#map-pane" target="_blank" rel="noopener noreferrer">the default panes<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to select the appropriate one.</p> <p>If you add a <code>panes</code> option to your layer descriptor we will create the dedicated panes for you under-the-hood so that you can then set in the <code>pane</code> option of any sublayer the pane it will belong to. Each pane must have a unique name and can be visible at specific zoom levels:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  name<span class="token operator">:</span> 'Layer'<span class="token punctuation">,</span>
  ...
  panes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> 'waypoints'<span class="token punctuation">,</span>
    minZoom<span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
    maxZoom<span class="token operator">:</span> <span class="token number">14</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="map-style"><a href="#map-style" aria-hidden="true" class="header-anchor">#</a> Map Style</h3> <p>Make it possible to generate Leaflet map objects with style based on (Geo)Json (feature) properties:</p> <ul><li><strong>convertFromSimpleStyleSpec(style)</strong> helper function to convert from <a href="https://github.com/mapbox/simplestyle-spec" target="_blank" rel="noopener noreferrer">simple style spec options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to <a href="https://leafletjs.com/reference.html#path-option" target="_blank" rel="noopener noreferrer">Leaflet style options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><strong>createMarkerFromStyle(latlng, style)</strong> helper function create a <a href="https://leafletjs.com/reference.html#marker" target="_blank" rel="noopener noreferrer">Leaflet marker<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> from marker style options:
<ul><li><strong>icon</strong> icon style options
<ul><li><strong>type</strong> type name (ie class) of the icon to be created for the marker</li> <li><strong>options</strong> icon constructor options</li></ul></li> <li><strong>type</strong> type name (ie class) of the marker to be created</li> <li><strong>options</strong> marker constructor options</li></ul></li> <li><strong>register/unregisterLeafletStyle(type, generator)</strong> (un)registers a function generating a Leaflet object depending on the given type:
<ul><li><code>markerStyle</code> =&gt; <strong>f(feature, latlng, options)</strong> returns a <a href="https://leafletjs.com/reference.html#marker" target="_blank" rel="noopener noreferrer">Leaflet marker<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><code>featureStyle</code> =&gt; <strong>f(feature, options)</strong> returns a <a href="https://leafletjs.com/reference.html#path-option" target="_blank" rel="noopener noreferrer">Leaflet style object<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><code>tooltip</code> =&gt; <strong>f(feature, layer, options)</strong> returns a <a href="https://leafletjs.com/reference.html#tooltip" target="_blank" rel="noopener noreferrer">Leaflet tooltip<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, see <a href="/kdk/api/kmap/mixins.html#map-tooltip">tooltip mixin</a></li> <li><code>popup</code> =&gt; <strong>f(feature, layer, options)</strong> returns a <a href="https://leafletjs.com/reference.html#popup" target="_blank" rel="noopener noreferrer">Leaflet popup<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, see <a href="/kdk/api/kmap/mixins.html#map-popup">popup mixin</a></li></ul></li></ul> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>The <a href="https://github.com/mapbox/simplestyle-spec" target="_blank" rel="noopener noreferrer">simple style spec options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> does not cover all <a href="https://leafletjs.com/reference.html#path-option" target="_blank" rel="noopener noreferrer">Leaflet style options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. However you can use it simply by converting option names from camel case to kebab case.</p></div> <p>The mixin automatically registers defaults styling:</p> <ul><li><code>markerStyle</code> =&gt; will create a marker based on the following options merged with the following order of precedence
<ul><li><a href="https://github.com/mapbox/simplestyle-spec" target="_blank" rel="noopener noreferrer">simple style spec options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> set on <strong>feature.style</strong> or <strong>feature.properties</strong></li> <li><a href="https://github.com/mapbox/simplestyle-spec" target="_blank" rel="noopener noreferrer">simple style spec options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> set on layer descriptor</li> <li><a href="https://leafletjs.com/reference.html#path-option" target="_blank" rel="noopener noreferrer">Leaflet style options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> set on the <strong>pointStyle</strong> property in the component</li></ul></li> <li><code>featureStyle</code> =&gt; will create a style based on the following options merged with the following order of precedence
<ul><li><a href="https://github.com/mapbox/simplestyle-spec" target="_blank" rel="noopener noreferrer">simple style spec options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> set on <strong>feature.style</strong> or <strong>feature.properties</strong></li> <li><a href="https://github.com/mapbox/simplestyle-spec" target="_blank" rel="noopener noreferrer">simple style spec options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> set on layer descriptor</li> <li><a href="https://leafletjs.com/reference.html#path-option" target="_blank" rel="noopener noreferrer">Leaflet style options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> set on the <strong>featureStyle</strong> property in the component</li></ul></li></ul> <h3 id="map-popup"><a href="#map-popup" aria-hidden="true" class="header-anchor">#</a> Map Popup</h3> <p>Make it possible to generate <a href="https://leafletjs.com/reference.html#popup" target="_blank" rel="noopener noreferrer">Leaflet popups<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> based on GeoJson feature properties:</p> <ul><li>use <strong>register/unregisterLeafletStyle(<code>popup</code>, generator)</strong> to (un)register a function <strong>f(feature, layer, options)</strong> returning a <a href="https://leafletjs.com/reference.html#popup" target="_blank" rel="noopener noreferrer">Leaflet popup<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>The mixin automatically registers a default generator that will create a popup displaying a property name/value table based on the following options with the following order of precedence</p> <ul><li><strong>popup</strong>: set on <strong>feature.properties</strong> or layer descriptor or in the <strong>popup</strong> property of component options
<ul><li><strong>pick</strong>: array of property names to appear in the popup</li> <li><strong>omit</strong>: array of property names not to appear in the popup</li> <li><strong>template</strong>: <a href="https://lodash.com/docs/#template" target="_blank" rel="noopener noreferrer">Lodash template<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to generate popup content with feature and its properties as context</li> <li><strong>text</strong>: text content of the popup, if provided will override default display</li> <li><strong>options</strong>: Leaflet <a href="https://leafletjs.com/reference.html#popup-option" target="_blank" rel="noopener noreferrer">popup options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul> <h3 id="map-tooltip"><a href="#map-tooltip" aria-hidden="true" class="header-anchor">#</a> Map Tooltip</h3> <p>Make it possible to generate <a href="https://leafletjs.com/reference.html#tooltip" target="_blank" rel="noopener noreferrer">Leaflet tooltips<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> based on GeoJson feature properties:</p> <ul><li>use <strong>register/unregisterLeafletStyle(<code>tooltip</code>, generator)</strong> to (un)register a function <strong>f(feature, layer, options)</strong> returning a <a href="https://leafletjs.com/reference.html#tooltip" target="_blank" rel="noopener noreferrer">Leaflet tooltip<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>The mixin automatically registers a default generator that will create a tooltip based on the following options with the following order of precedence</p> <ul><li><strong>tooltip</strong>: set on <strong>feature.properties</strong> or layer descriptor or in the <strong>tooltip</strong> property of component options
<ul><li><strong>property</strong>: property name to appear in the tooltip</li> <li><strong>template</strong>: <a href="https://lodash.com/docs/#template" target="_blank" rel="noopener noreferrer">Lodash template<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to generate tooltip content with feature and its properties as context</li> <li><strong>text</strong>: text content of the tooltip, if provided will override default display</li> <li><strong>options</strong>: Leaflet <a href="https://leafletjs.com/reference.html#tooltip-option" target="_blank" rel="noopener noreferrer">tooltip options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul> <h3 id="geojson-layer"><a href="#geojson-layer" aria-hidden="true" class="header-anchor">#</a> GeoJson Layer</h3> <p>Make it possible to manage and style raw or time-based GeoJson map layers (<a href="https://github.com/perliedman/leaflet-realtime" target="_blank" rel="noopener noreferrer">Leaflet.Realtime plugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is used under-the-hood):</p> <ul><li><strong>createLeafletGeoJsonLayer(options)</strong> automatically registered GeoJson Leaflet layer constructor</li> <li><strong>updateLayer(name, geoJson, remove)</strong> update underlying GeoJson data of a given layer, if <code>remove</code> is <code>true</code> it will remove given features from the layer, otherwise it will add new ones found and update matching ones based on the <code>featureId</code> option</li></ul> <div class="danger custom-block"><p class="custom-block-title">WARNING</p> <p>The <a href="/kdk/api/kmap/mixins.html#map-style">style mixin</a> is mandatory when using this mixin. If you'd like to support popups/tooltips you should also use the <a href="/kdk/api/kmap/mixins.html#map-tooltip">popup mixin</a> and/or <a href="/kdk/api/kmap/mixins.html#map-tooltip">tooltip mixin</a>.</p></div> <p>If your component has a <strong>onLeafletFeature(feature, layer, options)</strong> method it will be called each time a new GeoJson feature is created.</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Marker cluster options are to be provided in the <strong>cluster</strong> property of the Leaflet layer options</p></div> <p>The following configuration illustrates a GeoJson marker cluster layer using options set on the layer descriptor (see image below):</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  name<span class="token operator">:</span> 'Layer'<span class="token punctuation">,</span>
  description<span class="token operator">:</span> 'My sites'<span class="token punctuation">,</span>
  tags<span class="token operator">:</span> <span class="token punctuation">[</span> 'business' <span class="token punctuation">]</span><span class="token punctuation">,</span>
  icon<span class="token operator">:</span> 'star'<span class="token punctuation">,</span>
  attribution<span class="token operator">:</span> '(c<span class="token punctuation">)</span> My company'<span class="token punctuation">,</span>
  type<span class="token operator">:</span> 'OverlayLayer'<span class="token punctuation">,</span>
  leaflet<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> 'geoJson'<span class="token punctuation">,</span>
    source<span class="token operator">:</span> 'https<span class="token operator">:</span>//s3.eu-central-<span class="token number">1.</span>amazonaws.com/kargo/nuclear-sites.json'<span class="token punctuation">,</span>
    cluster<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    'marker-color'<span class="token operator">:</span> 'orange'<span class="token punctuation">,</span>
    'icon-color'<span class="token operator">:</span> 'white'<span class="token punctuation">,</span>
    'icon-classes'<span class="token operator">:</span> 'fa fa-star'<span class="token punctuation">,</span>
    popup<span class="token operator">:</span> <span class="token punctuation">{</span>
      pick<span class="token operator">:</span> <span class="token punctuation">[</span> 'NAME' <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    tooltip<span class="token operator">:</span> <span class="token punctuation">{</span>
      property<span class="token operator">:</span> 'LABEL'
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="/kdk/assets/img/marker-cluster-2D.63ae3032.png" alt="2D marker cluster"></p> <h4 id="dynamic-styling"><a href="#dynamic-styling" aria-hidden="true" class="header-anchor">#</a> Dynamic styling</h4> <p>Usually the same style is used for all features of a GeoJson layer, you might however require a more dynamic style base on each feature properties. To handle this use case you can either:</p> <ul><li>provide styling options for each feature in their <code>properties</code> or <code>style</code> field</li> <li>use <a href="https://lodash.com/docs/#template" target="_blank" rel="noopener noreferrer">Lodash templating<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> on layer styling options with feature and its properties as context</li></ul> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>Templating can only be efficient if compilers are created upfront, as a consequence you need to declare the list of templated options in your layer styling using the <code>template</code> property.</p></div> <p>For instance you can change the marker color or image based on a given features's property like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'marker-color'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;% if (properties.visibility &lt; 75) { %&gt;#000000&lt;% }
                  else if (properties.visibility &lt; 300) { %&gt;#d20200&lt;% }
                  else if (properties.visibility &lt; 1500) { %&gt;#f9b40f&lt;% }
                  else if (properties.visibility &lt; 3000) { %&gt;#eef52f&lt;% }
                  else { %&gt;#33c137&lt;% } %&gt;`</span></span><span class="token punctuation">,</span>
<span class="token string">'marker-symbol'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;% if (properties.visibility &lt; 75) { %&gt;/statics/windyblack.png&lt;% }
                    else if (properties.visibility &lt; 300) { %&gt;/statics/windyred.png&lt;% }
                    else if (properties.visibility &lt; 1500) { %&gt;/statics/windyorange.png&lt;% }
                    else if (properties.visibility &lt; 3000) { %&gt;/statics/windyyellow.png&lt;% }
                    else { %&gt;/statics/windygreen.png&lt;% } %&gt;`</span></span><span class="token punctuation">,</span>
template<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'marker-color'</span><span class="token punctuation">,</span> <span class="token string">'marker-symbol'</span><span class="token punctuation">]</span>
</code></pre></div><p>You can also draw a path with a different styling on each part like this:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  type<span class="token operator">:</span> 'FeatureCollection'<span class="token punctuation">,</span>
  features<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span> 'Feature'<span class="token punctuation">,</span>
    properties<span class="token operator">:</span> <span class="token punctuation">{</span> stroke<span class="token operator">:</span> '#<span class="token number">000000</span>'<span class="token punctuation">,</span> weight<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    geometry<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> 'LineString'<span class="token punctuation">,</span> coordinates<span class="token operator">:</span> <span class="token punctuation">[</span>...<span class="token punctuation">]</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> 'Feature'<span class="token punctuation">,</span>
    properties<span class="token operator">:</span> <span class="token punctuation">{</span> stroke<span class="token operator">:</span> '#FF00FF'<span class="token punctuation">,</span> weight<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    geometry<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> 'LineString'<span class="token punctuation">,</span> coordinates<span class="token operator">:</span> <span class="token punctuation">[</span>...<span class="token punctuation">]</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="edit-layer"><a href="#edit-layer" aria-hidden="true" class="header-anchor">#</a> Edit Layer</h3> <p>Make it possible to edit features of a <a href="/kdk/api/kmap/mixins.html#geojson-layer">GeoJson layer</a> (geometry and properties):</p> <ul><li><strong>editLayer(name)</strong> start/stop layer edition on a given layer</li></ul> <p>As a consequence it has to be used with the GeoJson layer mixin and will use the configured styling.</p> <h3 id="file-layer"><a href="#file-layer" aria-hidden="true" class="header-anchor">#</a> File Layer</h3> <p>Make it possible to drag'n'drop GeoJson or KML file on the map (<a href="https://github.com/makinacorpus/Leaflet.FileLayer" target="_blank" rel="noopener noreferrer">Leaflet.FileLayer plugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is used under-the-hood). It will automatically create a new <a href="/kdk/api/kmap/mixins.html#geojson-layer">GeoJson layer</a> named after the filename on drop. As a consequence it has to be used with the GeoJson layer mixin and will use the configured styling.</p> <h3 id="forecast-layer"><a href="#forecast-layer" aria-hidden="true" class="header-anchor">#</a> Forecast Layer</h3> <p>Make it possible to manage <a href="https://weacast.github.io/weacast-docs/api/layers.html#forecast-data-layers" target="_blank" rel="noopener noreferrer">Weacast map layers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</p> <ul><li><strong>createLeafletForecastLayer(options)</strong> automatically registered Weacast Leaflet layer constructor</li></ul> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>This mixin assumes that your component has initialized its <a href="https://weacast.github.io/weacast-docs/api/application.html#client-setup" target="_blank" rel="noopener noreferrer">Weacast client<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in the <code>weacastApi</code> property by using e.g. the <a href="/kdk/api/kmap/mixins.html#weacast">Weacast mixin</a></p></div> <h2 id="globe"><a href="#globe" aria-hidden="true" class="header-anchor">#</a> Globe</h2> <p>The underlying globe object is based on <a href="https://cesium.com/" target="_blank" rel="noopener noreferrer">Cesium<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="base-globe"><a href="#base-globe" aria-hidden="true" class="header-anchor">#</a> Base Globe</h3> <div class="danger custom-block"><p class="custom-block-title">WARNING</p> <p>This mixin is a mandatory one to build a globe activity</p></div> <p>Make it possible to manage globe layers and extend supported layer types:</p> <ul><li><strong>setupGlobe(domElement, token)</strong> creates the underlying Cesium globe object with given Cesium Ion token</li> <li><strong>addLayer(options)/removeLayer(name)</strong> registers/destroys a layer based on a <a href="/kdk/api/kmap/services.html#catalog">catalog layer descriptor</a></li> <li><strong>showLayer/hideLayer(name)</strong> (un)hides the given layer in globe, on first show the layer will be lazily created</li> <li><strong>hasLayer(name)</strong> check if a given layer is already registered</li> <li><strong>isLayerVisible(name)</strong> check if a given layer is visible and underlying Cesium object created</li> <li><strong>zoomToLayer(name)</strong> fits the globe view to visualize a given layer</li> <li><strong>zoomToBounds(bounds)</strong> fits the globe view to visualize a given extent as bounds [ [south, west], [north, east] ]</li> <li><strong>getLayerByName(name)</strong> retrieve the <a href="/kdk/api/kmap/services.html#catalog">catalog layer descriptor</a> for a given layer</li> <li><strong>getCesiumLayerByName(name)</strong> retrieve the underlying Cesium object for a given layer</li> <li><strong>createCesiumLayer(options)</strong> creates the underlying Cesium object based on a <a href="/kdk/api/kmap/services.html#catalog">catalog layer descriptor</a>, will check all registered constructor for any one matching</li> <li><strong>registerCesiumConstructor(constructor)</strong> registers a Cesium constructor function for a given type of layer</li> <li><strong>center(longitude, latitude, altitude, heading, pitch, roll)</strong> centers the globe view to visualize a given point at a given altitude with and orientation (default is pointing ground vertically [0, 0, -90])</li> <li><strong>getCenter()</strong> get the current globe view center as longitude, latitude and altitude</li></ul> <h3 id="globe-style"><a href="#globe-style" aria-hidden="true" class="header-anchor">#</a> Globe Style</h3> <p>Make it possible to setup Cesium entities objects with style based on (Geo)Json (feature) properties stored in entities:</p> <ul><li><strong>convertFromSimpleStyleSpec(style)</strong> helper function to convert from <a href="https://github.com/mapbox/simplestyle-spec" target="_blank" rel="noopener noreferrer">simple style spec options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to <a href="https://cesiumjs.org/Cesium/Build/Documentation/GeoJsonDataSource.html#.load" target="_blank" rel="noopener noreferrer">Cesium style options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><strong>convertToCesiumObjects(style)</strong> helper function to convert from JSON description to Cesium objects</li> <li><strong>register/unregisterCesiumStyle(type, generator)</strong> (un)registers a function generating a Cesium object depending on the given type:
<ul><li><code>entityStyle</code> =&gt; <strong>f(entity, options)</strong> returns a <a href="https://cesium.com/docs/tutorials/creating-entities/" target="_blank" rel="noopener noreferrer">Cesium entity style object<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><code>clusterStyle</code> =&gt; <strong>f(entities, cluster, options)</strong> returns a <a href="https://cesiumjs.org/Cesium/Build/Documentation/EntityCluster.html#~newClusterCallback" target="_blank" rel="noopener noreferrer">Cesium cluster style object<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul> <p>The mixin automatically registers defaults styling:</p> <ul><li><code>entityStyle</code> =&gt; will create a style based on the following options merged with the following order of precedence
<ul><li><a href="https://github.com/mapbox/simplestyle-spec" target="_blank" rel="noopener noreferrer">simple style spec options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> set on <strong>feature.style</strong> or <strong>feature.properties</strong></li> <li><a href="https://cesium.com/docs/tutorials/creating-entities/" target="_blank" rel="noopener noreferrer">Cesium entity style options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> set on layer descriptor</li> <li><a href="https://cesium.com/docs/tutorials/creating-entities/" target="_blank" rel="noopener noreferrer">Cesium entity style options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> set on the <strong>entityStyle</strong> property in the component options</li></ul></li> <li><code>clusterStyle</code> =&gt; will create a style based on the following options merged with the following order of precedence
<ul><li><a href="https://cesiumjs.org/Cesium/Build/Documentation/EntityCluster.html#~newClusterCallback" target="_blank" rel="noopener noreferrer">Cesium cluster style options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> set on layer descriptor</li> <li><a href="https://cesiumjs.org/Cesium/Build/Documentation/EntityCluster.html#~newClusterCallback" target="_blank" rel="noopener noreferrer">Cesium cluster style options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> set on the <strong>clusterStyle</strong> property in the component options</li></ul></li></ul> <p>Cesium styles often rely on dynamically created objects while the input styling configuration is a static JSON. As a consequence the following rules are used to convert from JSON to Cesium objects:</p> <ul><li>constants are expressed as strings starting with <code>'Cesium.'</code></li> <li>object instances are expressed as a <code>{ type, options }</code> object where type is a string starting with <code>'Cesium.'</code> followed by the class name like <code>'Cesium.CheckerboardMaterialProperty'</code>, options are constructor options for the object instance
The following Cesium code:</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>ellipse<span class="token punctuation">.</span>material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>CheckerboardMaterialProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  evenColor <span class="token punctuation">:</span> Cesium<span class="token punctuation">.</span>Color<span class="token punctuation">.</span><span class="token constant">WHITE</span><span class="token punctuation">,</span>
  oddColor <span class="token punctuation">:</span> Cesium<span class="token punctuation">.</span>Color<span class="token punctuation">.</span><span class="token constant">BLACK</span><span class="token punctuation">,</span>
  repeat <span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cartesian2</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>will result in the following Json configuration:</p> <div class="language-json extra-class"><pre class="language-json"><code>ellipse<span class="token operator">:</span> <span class="token punctuation">{</span>
  material<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> 'Cesium.CheckerboardMaterialProperty'<span class="token punctuation">,</span>
    options<span class="token operator">:</span> <span class="token punctuation">{</span>
      evenColor<span class="token operator">:</span> 'Cesium.Color.WHITE'<span class="token punctuation">,</span>
      oddColor<span class="token operator">:</span> 'Cesium.Color.BLACK'<span class="token punctuation">,</span>
      repeat<span class="token operator">:</span> <span class="token punctuation">{</span>
        type<span class="token operator">:</span> 'Cesium.Cartesian2'<span class="token punctuation">,</span>
        options<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="globe-popup"><a href="#globe-popup" aria-hidden="true" class="header-anchor">#</a> Globe Popup</h3> <p>Make it possible to generate <a href="https://cesiumjs.org/Cesium/Build/Documentation/LabelGraphics.html" target="_blank" rel="noopener noreferrer">Cesium labels<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as popups based on GeoJson feature properties stored in entities:</p> <ul><li>use <strong>register/unregisterCesiumStyle(<code>popup</code>, generator)</strong> to (un)register a function <strong>f(entity, options)</strong> returning a <a href="https://cesium.com/docs/tutorials/creating-entities/" target="_blank" rel="noopener noreferrer">Cesium entity style object<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>The mixin automatically registers a default generator that will create a popup displaying a property name/value table based on the following options with the following order of precedence</p> <ul><li><strong>popup</strong>: set on <strong>entity.properties</strong> or layer descriptor or in the <strong>popup</strong> property of component options
<ul><li><strong>pick</strong>: array of property names to appear in the popup</li> <li><strong>omit</strong>: array of property names not to appear in the popup</li> <li><strong>template</strong>: <a href="https://lodash.com/docs/#template" target="_blank" rel="noopener noreferrer">Lodash template<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to generate popup content with feature and its properties as context</li> <li><strong>html</strong>: HTML content of the popup, if provided will override default display</li> <li><strong>options</strong>: Cesium <a href="https://cesiumjs.org/Cesium/Build/Documentation/LabelGraphics.html" target="_blank" rel="noopener noreferrer">label options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul> <h3 id="globe-tooltip"><a href="#globe-tooltip" aria-hidden="true" class="header-anchor">#</a> Globe Tooltip</h3> <p>Make it possible to generate <a href="https://cesiumjs.org/Cesium/Build/Documentation/LabelGraphics.html" target="_blank" rel="noopener noreferrer">Cesium labels<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as tooltips based on GeoJson feature properties stored in entities:</p> <ul><li>use <strong>register/unregisterCesiumStyle(<code>tooltip</code>, generator)</strong> to (un)register a function <strong>f(entity, options)</strong> returning a <a href="https://cesium.com/docs/tutorials/creating-entities/" target="_blank" rel="noopener noreferrer">Cesium entity style object<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>The mixin automatically registers a default generator that will create a tooltip based on the following options with the following order of precedence</p> <ul><li><strong>tooltip</strong>: set on <strong>entity.properties</strong> or layer descriptor or in the <strong>tooltip</strong> property of component options
<ul><li><strong>property</strong>: property name to appear in the tooltip</li> <li><strong>template</strong>: <a href="https://lodash.com/docs/#template" target="_blank" rel="noopener noreferrer">Lodash template<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to generate tooltip content with feature and its properties as context</li> <li><strong>html</strong>: HTML content of the tooltip, if provided will override default display</li> <li><strong>options</strong>: Cesium <a href="https://cesiumjs.org/Cesium/Build/Documentation/LabelGraphics.html" target="_blank" rel="noopener noreferrer">label options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul> <h3 id="geojson-layer-2"><a href="#geojson-layer-2" aria-hidden="true" class="header-anchor">#</a> GeoJson Layer</h3> <p>Make it possible to manage and style raw or time-based GeoJson map layers:</p> <ul><li><strong>createCesiumGeoJsonLayer(options)</strong> automatically registered GeoJson Cesium layer constructor</li> <li><strong>updateLayer(name, geoJson)</strong> update underlying GeoJson data of a given layer</li></ul> <div class="danger custom-block"><p class="custom-block-title">WARNING</p> <p>The <a href="/kdk/api/kmap/mixins.html#globe-style">style mixin</a> is mandatory when using this mixin. If you'd like to support popups/tooltips you should also use the <a href="/kdk/api/kmap/mixins.html#globe-tooltip">popup mixin</a> and/or <a href="/kdk/api/kmap/mixins.html#globe-tooltip">tooltip mixin</a>.</p></div> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Marker cluster options are to be provided in the <strong>cluster</strong> property of the Cesium layer options</p></div> <p>The following configuration illustrates a GeoJson marker cluster layer using options set on the layer descriptor (see image below):</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  name<span class="token operator">:</span> 'Layer'<span class="token punctuation">,</span>
  description<span class="token operator">:</span> 'My sites'<span class="token punctuation">,</span>
  tags<span class="token operator">:</span> <span class="token punctuation">[</span> 'business' <span class="token punctuation">]</span><span class="token punctuation">,</span>
  icon<span class="token operator">:</span> 'star'<span class="token punctuation">,</span>
  attribution<span class="token operator">:</span> '(c<span class="token punctuation">)</span> My company'<span class="token punctuation">,</span>
  type<span class="token operator">:</span> 'OverlayLayer'<span class="token punctuation">,</span>
  cesium<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> 'geoJson'<span class="token punctuation">,</span>
    source<span class="token operator">:</span> 'https<span class="token operator">:</span>//s3.eu-central-<span class="token number">1.</span>amazonaws.com/kargo/nuclear-sites.json'<span class="token punctuation">,</span>
    cluster<span class="token operator">:</span> <span class="token punctuation">{</span>
      pixelRange<span class="token operator">:</span> <span class="token number">50</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    'marker-symbol'<span class="token operator">:</span> 'star'<span class="token punctuation">,</span>
    'marker-color'<span class="token operator">:</span> '#FFA500'
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="/kdk/assets/img/marker-cluster-3D.e8927429.png" alt="3D marker cluster"></p> <h4 id="dynamic-styling-2"><a href="#dynamic-styling-2" aria-hidden="true" class="header-anchor">#</a> Dynamic styling</h4> <p>The same than for <a href="/kdk/api/kmap/mixins.html#dynamic-styling">dynamic map style</a> applies for globe. Note however that templating will be applied once the 3D entities have been created, which means that you cannot use templating on <a href="https://github.com/mapbox/simplestyle-spec" target="_blank" rel="noopener noreferrer">simple style spec options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> but rather on Cesium object options set on the <code>entityStyle</code> layer option.</p> <p>For instance you can change the marker color or image based on a given features's property like this:</p> <div class="language-json extra-class"><pre class="language-json"><code>entityStyle<span class="token operator">:</span> <span class="token punctuation">{</span>
  billboard<span class="token operator">:</span> <span class="token punctuation">{</span>
    image<span class="token operator">:</span> `&lt;% if (properties.visibility &lt; <span class="token number">75</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> %&gt;/statics/windyblack.png&lt;% <span class="token punctuation">}</span>
              else if (properties.visibility &lt; <span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> %&gt;/statics/windyred.png&lt;% <span class="token punctuation">}</span>
              else if (properties.visibility &lt; <span class="token number">1500</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> %&gt;/statics/windyorange.png&lt;% <span class="token punctuation">}</span>
              else if (properties.visibility &lt; <span class="token number">3000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> %&gt;/statics/windyyellow.png&lt;% <span class="token punctuation">}</span>
              else <span class="token punctuation">{</span> %&gt;/statics/windygreen.png&lt;% <span class="token punctuation">}</span> %&gt;`<span class="token punctuation">,</span>
    color<span class="token operator">:</span> `Cesium.Color.&lt;% if (properties.visibility &lt; <span class="token number">75</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> %&gt;BLACK&lt;% <span class="token punctuation">}</span>
              else if (properties.visibility &lt; <span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> %&gt;ORANGERED&lt;% <span class="token punctuation">}</span>
              else if (properties.visibility &lt; <span class="token number">1500</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> %&gt;GOLD&lt;% <span class="token punctuation">}</span>
              else if (properties.visibility &lt; <span class="token number">3000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> %&gt;YELLOW&lt;% <span class="token punctuation">}</span>
              else <span class="token punctuation">{</span> %&gt;LIMEGREEN&lt;% <span class="token punctuation">}</span> %&gt;&quot;/&gt;`
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token punctuation">[</span>'billboard.image'<span class="token punctuation">,</span> 'billboard.color'<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You can also draw a path with a different styling on each part like this:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  type<span class="token operator">:</span> 'FeatureCollection'<span class="token punctuation">,</span>
  features<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span> 'Feature'<span class="token punctuation">,</span>
    properties<span class="token operator">:</span> <span class="token punctuation">{</span> stroke<span class="token operator">:</span> '#<span class="token number">000000</span>'<span class="token punctuation">,</span> weight<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    geometry<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> 'LineString'<span class="token punctuation">,</span> coordinates<span class="token operator">:</span> <span class="token punctuation">[</span>...<span class="token punctuation">]</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> 'Feature'<span class="token punctuation">,</span>
    properties<span class="token operator">:</span> <span class="token punctuation">{</span> stroke<span class="token operator">:</span> '#FF00FF'<span class="token punctuation">,</span> weight<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    geometry<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> 'LineString'<span class="token punctuation">,</span> coordinates<span class="token operator">:</span> <span class="token punctuation">[</span>...<span class="token punctuation">]</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="file-layer-2"><a href="#file-layer-2" aria-hidden="true" class="header-anchor">#</a> File Layer</h3> <p>Make it possible to drag'n'drop GeoJson or KML file on the globe. It will automatically create a new <a href="/kdk/api/kmap/mixins.html#geojson-layer">GeoJson layer</a> named after the filename on drop. As a consequence it has to be used with the GeoJson layer mixin and will use the configured styling.</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/kdk/api/kmap/components.html" class="prev">
          Components
        </a></span> <span class="next"><a href="/kdk/api/kteam/">
          Overview
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/kdk/assets/js/app.036b59a9.js" defer></script><script src="/kdk/assets/js/7.68a9ee17.js" defer></script>
  </body>
</html>
