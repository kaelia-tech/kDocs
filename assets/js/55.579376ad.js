(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{228:function(e,t,a){"use strict";a.r(t);var r=a(0),n=Object(r.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[e._m(0),e._v(" "),a("p",[e._v("The generation is based on the "),a("a",{attrs:{href:"https://github.com/openmaptiles/openmaptiles",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenMapTiles"),a("OutboundLink")],1),e._v(" project toolbox.")]),e._v(" "),a("p",[e._v("To generate OSM data we start from a fresh Scaleway server with a Docker image, it already contains docker, git, pip, gcc, etc.")]),e._v(" "),e._m(1),e._v(" "),a("p",[e._v("Because you will need a lot of storage here is "),a("a",{attrs:{href:"https://www.scaleway.com/docs/attach-and-detach-a-volume-to-an-existing-server/",target:"_blank",rel:"noopener noreferrer"}},[e._v("how to add a volume"),a("OutboundLink")],1),e._v(":")]),e._v(" "),e._m(2),a("p",[e._v("To automount it: https://community.online.net/t/automatic-mounting-of-additional-volumes-using-systemd-on-ubuntu/3102")]),e._v(" "),a("p",[e._v("Because some data (eg PG data) are generated in docker volumes it is necessary to "),a("a",{attrs:{href:"https://forums.docker.com/t/how-do-i-change-the-docker-image-installation-directory/1169",target:"_blank",rel:"noopener noreferrer"}},[e._v("change the default docker location to your volumes"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("Rendering the whole planet is a "),a("a",{attrs:{href:"https://github.com/openmaptiles/openmaptiles/issues/242",target:"_blank",rel:"noopener noreferrer"}},[e._v("tricky thing"),a("OutboundLink")],1),e._v(", so for now we prefer to:")]),e._v(" "),a("ul",[a("li",[e._v("contribute with a Pull Request to the community maintained open-source official vector tile schema so that the changes will be part of the future public OpenMapTiles releases and maintained")]),e._v(" "),a("li",[e._v("render only the features needed into a separate MBTiles files with new layers - and combine the standard planet with the extra layers - this is doable easily with JSON GL style and software stack powered by mapnik or tippecanoe.")]),e._v(" "),a("li",[e._v("the extra layers can be also generated on demand directly from PostGIS by a third party tileservers and combined into a single map with TileServer GL - and served via composed vector tiles or raster tiles\n"),a("ul",[a("li",[a("a",{attrs:{href:"http://geoserver.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("GeoServer"),a("OutboundLink")],1),e._v(" as vector/raster tiles")]),e._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/terranodo/tegola",target:"_blank",rel:"noopener noreferrer"}},[e._v("Tegola"),a("OutboundLink")],1),e._v(" directly as MVT")]),e._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/t-rex-tileserver/t-rex",target:"_blank",rel:"noopener noreferrer"}},[e._v("T-Rex"),a("OutboundLink")],1),e._v(" directly as MVT")])])])]),e._v(" "),a("p",[e._v("For small extractions it's possible to use the "),a("a",{attrs:{href:"http://overpass-turbo.eu/",target:"_blank",rel:"noopener noreferrer"}},[e._v("OverPass API"),a("OutboundLink")],1),e._v(", eg to extract taxiways/runways in a zone:")]),e._v(" "),e._m(3),a("p",[e._v("We also use the "),a("a",{attrs:{href:"https://github.com/openmaptiles/openmaptiles/blob/master/QUICKSTART.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("quickstart script"),a("OutboundLink")],1),e._v(" to generate data (the link contains useful information about required architecture/sizing):")]),e._v(" "),e._m(4),a("p",[e._v("For a layer covering the planet first download the "),a("a",{attrs:{href:"https://planet.openstreetmap.org/pbf/",target:"_blank",rel:"noopener noreferrer"}},[e._v("whole planet"),a("OutboundLink")],1),e._v(" in the "),a("em",[e._v("data")]),e._v(" directory and launch the process:")]),e._v(" "),e._m(5),e._m(6),e._v(" "),e._m(7),e._v(" "),e._m(8),a("p",[e._v("Here is a list of interesting documentation:")]),e._v(" "),a("ul",[e._m(9),e._v(" "),a("li",[a("a",{attrs:{href:"http://fuzzytolerance.info/blog/2017/04/25/Generating-your-own-OpenMapTiles/",target:"_blank",rel:"noopener noreferrer"}},[e._v("tutorial video"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://www.youtube.com/watch?v=D7mmXonFIqA&feature=youtu.be",target:"_blank",rel:"noopener noreferrer"}},[e._v("mapbox presentation"),a("OutboundLink")],1)])])])},[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",{attrs:{id:"openstreetmap"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#openstreetmap","aria-hidden":"true"}},[this._v("#")]),this._v(" OpenStreetMap")])},function(){var e=this.$createElement,t=this._self._c||e;return t("blockquote",[t("p",[this._v("Git clone using HTTPS instead of git protocol on Scaleway.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("mkfs -t ext4 /dev/nbd1\n"),t("span",{pre:!0,attrs:{class:"token function"}},[this._v("mkdir")]),this._v(" -p /mnt/data\n"),t("span",{pre:!0,attrs:{class:"token function"}},[this._v("mount")]),this._v(" /dev/nbd1 /mnt/data\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v('[out:json][timeout:25];\n// gather results\n(\n  // query part for: “aeroway=runway”\n  node["aeroway"="runway"]({{bbox}});\n  way["aeroway"="runway"]({{bbox}});\n  relation["aeroway"="runway"]({{bbox}});\n  // query part for: “aeroway=taxiway”\n  node["aeroway"="taxiway"]({{bbox}});\n  way["aeroway"="taxiway"]({{bbox}});\n  relation["aeroway"="taxiway"]({{bbox}});\n);\n// print results\nout body;\n>;\nout skel qt;\n')])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("git clone https://github.com/openmaptiles/openmaptiles\ncd openmaptiles\nmake\n./quickstart.sh france > logs 2>&1 & // could be country, region, etc. but not planet\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("cd data\nwget https://planet.openstreetmap.org/pbf/planet-latest.osm.pbf\nmv planet-latest.osm.pbf planet.osm.pbf\ncd ..\n./quickstart.sh planet > logs 2>&1 &\n// To see result\ndocker run -it --rm -v /mnt/data/openmaptiles/data:/data -p 80:80 klokantech/tileserver-gl\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Using a Scaleway C2L configuration (€23.99/mo, €0.048/hour, 8 Dedicated X86 64bit Cores, 32GB memory, 250GB Direct SSD, 800Mbit/s Unmetered) processing the "),t("code",[this._v("aeroway")]),this._v(" layer on the planet takes ~ 16 000 s and 120 GB.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("blockquote",[t("p",[this._v("Launching the script against the same data set again does not seem to correctly update the generation configuration. You should clean everything before relaunching:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("make clean-docker\nmake forced-clean-sql\nrm -fr data build\nmake\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("a",{attrs:{href:"./Updatable%20Vector%20Tiles%20from%20OpenStreetMap.pdf"}},[this._v("kloklantech thesis")]),this._v(" detailing the whole toolchain")])}],!1,null,null,null);n.options.__file="osm.md";t.default=n.exports}}]);