(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{172:function(t,e,s){t.exports=s.p+"assets/img/application-hooks.e15ca2e0.svg"},238:function(t,e,s){"use strict";s.r(e);var a=[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"application"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#application","aria-hidden":"true"}},[this._v("#")]),this._v(" Application")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"application-api"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#application-api","aria-hidden":"true"}},[this._v("#")]),this._v(" Application API")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"backend-setup"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#backend-setup","aria-hidden":"true"}},[this._v("#")]),this._v(" Backend setup")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" kalisio "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'kCore'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Initialize app")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("kalisio")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Connect to DB")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"client-setup"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#client-setup","aria-hidden":"true"}},[this._v("#")]),this._v(" Client setup")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" kalisio "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'kCore/client'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Initialize API wrapper")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" api "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("kalisio")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Retrieve a given service")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" users "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" api"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getService")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'users'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuration","aria-hidden":"true"}},[this._v("#")]),this._v(" Configuration")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'property'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" config "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'config'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("property\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"getservice-name-context"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#getservice-name-context","aria-hidden":"true"}},[this._v("#")]),this._v(" getService(name, context)")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("TIP")]),this._v(" "),e("p",[this._v("backend/client")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("On the client side this is also used to instanciate the service on first call.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"createservice-name-options"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#createservice-name-options","aria-hidden":"true"}},[this._v("#")]),this._v(" createService(name, options)")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("TIP")]),this._v(" "),e("p",[this._v("backend only")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("strong",[this._v("context")]),this._v(": the context object the service will be contextual to, if given the internal service path will be "),e("code",[this._v("contextId/serviceName")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("strong",[this._v("modelsPath")]),this._v(": directory where to find model declaration (optional), if provided will initiate a DB service based on the model file")])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("strong",[this._v("servicesPath")]),this._v(": directory where to find service declaration (optional), if provided for a non-DB service will initiate a service based on the returned object or constructor function from the service module, for a DB service it will apply the provided mixin object coming from the service module")])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("strong",[this._v("fileName")]),this._v(": by default the function will look to a model/service file named after the service name, this option allows to override it")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("li",[s("strong",[t._v("proxy")]),t._v(": options for a service to be proxied by the created service\n"),s("ul",[s("li",[s("strong",[t._v("service")]),t._v(": the name of the proxied service")]),t._v(" "),s("li",[s("strong",[t._v("params")]),t._v(": the parameters to be used when calling the proxied service, either an object or a function returning the object and applied on the input parameters")]),t._v(" "),s("li",[s("strong",[t._v("id")]),t._v(": the id map function to be used when calling the proxied service, will be applied on the input id")]),t._v(" "),s("li",[s("strong",[t._v("data")]),t._v(": the data map function to be used when calling the proxied service, will be applied on the input the object")]),t._v(" "),s("li",[s("strong",[t._v("result")]),t._v(": the result map to be used when calling the proxied service, will be applied on the returning the object(s)")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Depending on the options you have to create a "),e("em",[this._v("models")]),this._v(" and "),e("em",[this._v("services")]),this._v(" directories containing the required files to declare your services, e.g. your folder/file hierarchy should look like this:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("em",[this._v("index.js")]),this._v(": contains adefault function instantiating all the services")])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("em",[this._v("serviceName.service.js")]),this._v(" : exporting the specific mixin or mixin constructor function associated to your service (optional)")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"application-hooks"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#application-hooks","aria-hidden":"true"}},[this._v("#")]),this._v(" Application Hooks")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The following "),e("a",{attrs:{href:"./HOOKS.MD"}},[this._v("hooks")]),this._v(" are usually globally executed on the application:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(172),alt:"Application hooks"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"permissions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#permissions","aria-hidden":"true"}},[this._v("#")]),this._v(" Permissions")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("at backend level, typically when accessing the API")]),this._v(" "),e("li",[this._v("at frontend level, typically before constructing the UI")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[s("code",[t._v("Roles.member")]),t._v(', usually a "standard" user')]),t._v(" "),s("li",[s("code",[t._v("Roles.manager")]),t._v(', usually a "privileged" user')]),t._v(" "),s("li",[s("code",[t._v("Roles.owner")]),t._v(', usually a "superuser" or "administrator"')])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The "),e("code",[this._v("create")]),this._v(", respectively "),e("code",[this._v("remove")]),this._v(", operation on the "),e("code",[this._v("authorisations")]),this._v(" service will:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ol",[s("li",[t._v("add, respectively remove, a privilege or permission level (e.g. "),s("code",[t._v("owner")]),t._v(" or "),s("code",[t._v("manager")]),t._v(")")]),t._v(" "),s("li",[t._v("for a subject (i.e. a user in most case but it could be generalized)")]),t._v(" "),s("li",[t._v("on a resource (e.g. an organisation).")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("The permission will be stored directly on the subject (i.e. user) object so that they are already available once authenticated.\nThey will be organised by resource types (what is called a "),s("em",[t._v("scope")]),t._v(") so that a user being the owner of the "),s("em",[t._v("feathers")]),t._v(" organisation\nwill be structured like this ("),s("em",[t._v("organisations")]),t._v(" is an "),s("em",[t._v("authorization scope")]),t._v(" on the user object):")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  email"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'xxx'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'xxx'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  organisations"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'feathers'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    _id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ID")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    permissions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'owner'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" permissions "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@kalisio/kdk-core'")]),t._v("\n\npermissions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defineAbilities"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("subject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" can"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cannot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("subject "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" subject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Subject can be null on anonymous access")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Anyone can create new organisations")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("can")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'service'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'organisations'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("can")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'create'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'organisations'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("subject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("organisations"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Check for authorisation scope")]),t._v("\n      subject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("organisations"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("organisation "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("organisation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Get user privilege level for this organisation")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" role "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" permissions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Roles"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("organisation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("permissions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("role "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" Roles"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("member"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Members have read-only access to organisation")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("can")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'read'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'organisations'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" _id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" organisation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_id "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("role "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" Roles"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("manager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Manager have read-write access to organisation")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("can")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'update'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'organisations'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" _id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" organisation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_id "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("role "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" Roles"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("owner"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Owners have full access to organisation")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("can")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'remove'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'organisations'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" _id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" organisation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_id "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The "),e("code",[this._v("can/cannot")]),this._v(" method requires three arguments to define permissions:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("li",[s("code",[t._v("service")]),t._v(" can be used to completely block access to a given service, otherwise specify either\n"),s("code",[t._v("get")]),t._v(", "),s("code",[t._v("find")]),t._v(", "),s("code",[t._v("create")]),t._v(", "),s("code",[t._v("update")]),t._v(", "),s("code",[t._v("patch")]),t._v(", or "),s("code",[t._v("remove")]),t._v(" service-level operation")])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("code",[this._v("read")]),this._v(" is an alias for "),e("code",[this._v("get")]),this._v(" + "),e("code",[this._v("find")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("li",[s("code",[t._v("all")]),t._v(" is an alias for "),s("code",[t._v("read")]),t._v(" + "),s("code",[t._v("create")]),t._v(" + "),s("code",[t._v("update")]),t._v(" + "),s("code",[t._v("remove")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"warning custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("WARNING")]),this._v(" "),e("p",[this._v("It is important to only use database fields for the conditions so it can be used for fetching records.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Once registered, rules can be enforced at API level using the "),e("code",[this._v("authorise")]),this._v(" application-level hook:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" hooks "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@kalisio/kdk-core'")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hooks")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  before"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    all"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("hooks"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("authorise"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"client-ecosystem"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#client-ecosystem","aria-hidden":"true"}},[this._v("#")]),this._v(" Client ecosystem")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"events"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#events","aria-hidden":"true"}},[this._v("#")]),this._v(" Events")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Events "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'quasar'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Register callback on event")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("myCallback")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("object"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nEvents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("$on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myEvent'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" myCallback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Unregister it")]),t._v("\nEvents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("$off")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myEvent'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" myCallback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("The event bus is notably used to be aware of state changes in the global store (see hereafter)")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"store"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#store","aria-hidden":"true"}},[this._v("#")]),this._v(" Store")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("A component-based system like the one offered by KDK has its local and global states. Each component has its local data, but the application has a global application state that can be accessed by any component of the application. This is the purpose of the "),e("strong",[this._v("Store")]),this._v(" singleton object: allow to get or update the global state and make any interested component aware of it in real-time through events. The available API is illustrated by this code sample:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Store "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'kCore/client'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Events "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'quasar'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("myCallback")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" previousValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nStore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myGlobal'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Set a root object")]),t._v("\nStore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("patch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myGlobal'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" property"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Set a specific group of properties")]),t._v("\nStore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myGlobal.property'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Set a specific property path")]),t._v("\nStore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myGlobal.property'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" defaultValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// defaultValue is returned if path is not found")]),t._v("\nEvents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("$on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myGlobal-changed'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" myCallback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// When updating a root object")]),t._v("\nEvents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("$on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myGlobal-property-changed'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" myCallback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// When updating a specific property path")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"context"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#context","aria-hidden":"true"}},[this._v("#")]),this._v(" Context")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("TODO")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"i18n"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#i18n","aria-hidden":"true"}},[this._v("#")]),this._v(" i18n")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"client-side-internationalization"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#client-side-internationalization","aria-hidden":"true"}},[this._v("#")]),this._v(" Client-side internationalization")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[t._v("a translation used in mulitple components has no prefix")]),t._v(" "),s("li",[t._v("a translation used in a single component is prefixed by the source component name")]),t._v(" "),s("li",[t._v("some prefixs are reserved\n"),s("ul",[s("li",[s("code",[t._v("errors")]),t._v(" for error messages")]),t._v(" "),s("li",[s("code",[t._v("schemas")]),t._v(" for labels in JSON schemas")])])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"CANCEL"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Cancel"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"errors"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"400"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Operation cannot be performed: bad parameters"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ...\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"schemas"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"AVATAR_FIELD_HELPER"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Select an avatar"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ...\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"KScreen"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"CLIENT_VERSION"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Client version"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ...\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  ...\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"server-side-internationalization"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#server-side-internationalization","aria-hidden":"true"}},[this._v("#")]),this._v(" Server-side internationalization")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" BadRequest "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@feathersjs/errors'")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Somewhere in a hook or service")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BadRequest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'The provided password does not comply to the password policy'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    translation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'WEAK_PASSWORD'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" failedRules"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("Events"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("$on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'error'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Translate the message if a translation key exists")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" translation "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" _"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data.translation'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("translation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("$t")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'errors.'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" translation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" translation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Overwrite the message using error code")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("code"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("$t")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'errors.'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("code"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("showError")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])}],n=s(0),r=Object(n.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),s("p",[t._v("Kalisio "),s("a",{attrs:{href:"https://github.com/kalisio/kCore",target:"_blank",rel:"noopener noreferrer"}},[t._v("core module"),s("OutboundLink")],1),t._v(" offers a thin layer on top of the "),s("a",{attrs:{href:"https://docs.feathersjs.com/api/application.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("FeathersJS application"),s("OutboundLink")],1),t._v(" mainly to simplify the creation and configuration of services. It also provide some helpful concepts and utilities to structure your application right.")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),s("p",[t._v("Kalisio "),s("a",{attrs:{href:"https://github.com/kalisio/kCore",target:"_blank",rel:"noopener noreferrer"}},[t._v("core module"),s("OutboundLink")],1),t._v(" provides a helper to quickly initialize what is required for your "),s("a",{attrs:{href:"https://docs.feathersjs.com/api/application.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("server application"),s("OutboundLink")],1),t._v(". The core module provides the ability to initialize a new Kalisio application instance, attach it to the configured database and setup authentication:")]),t._v(" "),t._m(3),t._m(4),t._v(" "),s("p",[t._v("Kalisio "),s("a",{attrs:{href:"https://github.com/kalisio/kCore",target:"_blank",rel:"noopener noreferrer"}},[t._v("core module"),s("OutboundLink")],1),t._v(" provides a helper to quickly initialize what is required for your "),s("a",{attrs:{href:"https://docs.feathersjs.com/api/client.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("client application"),s("OutboundLink")],1),t._v(".")]),t._v(" "),t._m(5),t._m(6),t._v(" "),s("p",[t._v("Any value from the backend "),s("router-link",{attrs:{to:"./../../guides/basics/step-by-step.html#configuring-a-kapp"}},[t._v("configuration")]),t._v(" can be directly retrieved on the application object like this:")],1),t._v(" "),t._m(7),s("p",[t._v("Any value from the frontend "),s("router-link",{attrs:{to:"./../../guides/basics/step-by-step.html#configuring-a-kapp"}},[t._v("configuration")]),t._v(" can be directly retrieved by importing it like this:")],1),t._v(" "),t._m(8),s("blockquote",[s("p",[t._v("Under the hood "),s("a",{attrs:{href:"https://github.com/feathersjs/configuration",target:"_blank",rel:"noopener noreferrer"}},[t._v("FeathersJS configuration module"),s("OutboundLink")],1),t._v(" and "),s("a",{attrs:{href:"https://github.com/lorenwest/node-config",target:"_blank",rel:"noopener noreferrer"}},[t._v("node-config"),s("OutboundLink")],1),t._v(" are used to manage configuration so that any related concept to organise your configuration according to deployment options can be used.")])]),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),s("p",[t._v("Retrieve the given service by name, should replace "),s("a",{attrs:{href:"https://docs.feathersjs.com/api/application.html#servicepath",target:"_blank",rel:"noopener noreferrer"}},[t._v("Feathers service method"),s("OutboundLink")],1),t._v(' so that you are abstracted away from the internal service path (i.e. API prefix and context ID) and only refer to it by its "usual" name.')]),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),s("p",[t._v("Create a new service attached to the application by name and given a set of options:")]),t._v(" "),s("ul",[t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),s("li",[s("strong",[t._v("events")]),t._v(": "),s("a",{attrs:{href:"https://docs.feathersjs.com/api/events.html#service-events",target:"_blank",rel:"noopener noreferrer"}},[t._v("service events"),s("OutboundLink")],1),t._v(" to be used by the service")]),t._v(" "),s("li",[s("strong",[t._v("perspectives")]),t._v(": the "),s("em",[t._v("perspectives")]),t._v(" of the model that will not be retrieved by default except if "),s("a",{attrs:{href:"https://docs.feathersjs.com/api/databases/querying.html#select",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("$select")]),s("OutboundLink")],1),t._v(" is used")]),t._v(" "),t._m(18)]),t._v(" "),t._m(19),t._v(" "),s("ul",[t._m(20),t._v(" "),s("li",[s("em",[t._v("models")]),t._v(" : constains one file per database adapter you'd like to support\n"),s("ul",[s("li",[s("em",[t._v("serviceName.model.mongodb.js")]),t._v(" : exporting the data model managed by your service in "),s("a",{attrs:{href:"https://docs.feathersjs.com/api/databases/mongodb.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("MongoDB"),s("OutboundLink")],1),t._v(",")]),t._v(" "),s("li",[s("em",[t._v("serviceName.model.levelup.js")]),t._v(" : exporting the data model managed by your service in "),s("a",{attrs:{href:"https://github.com/feathersjs/feathers-levelup",target:"_blank",rel:"noopener noreferrer"}},[t._v("LevelUP"),s("OutboundLink")],1),t._v(",")]),t._v(" "),s("li",[t._v("...")])])]),t._v(" "),s("li",[s("em",[t._v("services")]),t._v(" "),s("ul",[s("li",[s("em",[t._v("serviceName")]),t._v(" "),s("ul",[s("li",[s("em",[t._v("serviceName.hooks.js")]),t._v(" : exporting the "),s("a",{attrs:{href:"https://docs.feathersjs.com/api/hooks.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("hooks"),s("OutboundLink")],1),t._v(" of your service,")]),t._v(" "),s("li",[s("em",[t._v("serviceName.filters.js")]),t._v(" : exporting the "),s("a",{attrs:{href:"https://docs.feathersjs.com/api/events.html#event-filtering",target:"_blank",rel:"noopener noreferrer"}},[t._v("filters"),s("OutboundLink")],1),t._v(" of your service,")]),t._v(" "),t._m(21)])])])])]),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),s("p",[t._v("We provide an isomorphic permissions management system so that user access can be checked:")]),t._v(" "),t._m(26),t._v(" "),s("p",[t._v("The primary level of a permissions management system is a "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Role-based_access_control",target:"_blank",rel:"noopener noreferrer"}},[t._v("Role Based Access Control"),s("OutboundLink")],1),t._v(" (RBAC), which relies on the grouping of users into various roles which are then assigned rights.\nA right is typically made up of an action and a resource type, e.g. role manager can create (action) documents (resource type).\nThe KDK provide the following default roles, ordered by privilege level:")]),t._v(" "),t._m(27),t._v(" "),s("p",[t._v("The secondary level of a permissions management system is an "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Attribute-based_access_control",target:"_blank",rel:"noopener noreferrer"}},[t._v("Attribute Based Access Control"),s("OutboundLink")],1),t._v(" (ABAC), which allows to enforce authorization decisions based on any attribute accessible to your application and not just the user's role. Let's say we'd like to give a specific user access to a specific resource and this resource is created/removed dynamically at run time by your app. RBAC is a legacy access control that usually fails in this kind of dynamic environments. ABAC is more flexible and powerful to support these use cases, and technically ABAC is also capable of enforcing RBAC. This is the reason why the KDK implements this type of access control.")]),t._v(" "),t._m(28),t._v(" "),t._m(29),t._v(" "),t._m(30),t._v(" "),t._m(31),s("p",[t._v("A hook system allows to register the different rules that should be enforced, "),s("a",{attrs:{href:"https://stalniy.github.io/casl/",target:"_blank",rel:"noopener noreferrer"}},[t._v("CASL"),s("OutboundLink")],1),t._v(" is used under-the-hood:")]),t._v(" "),t._m(32),t._m(33),t._v(" "),s("ul",[s("li",[t._v("the first one is the action or the set of actions you're setting the permission for\n"),s("ul",[t._m(34),t._v(" "),t._m(35),t._v(" "),t._m(36),t._v(" "),s("li",[s("code",[t._v("update")]),t._v(" is an alias for "),s("code",[t._v("patch")]),t._v(" as objects are usually only patched due to "),s("router-link",{attrs:{to:"./../#data-model"}},[t._v("perspectives")])],1)])]),t._v(" "),s("li",[t._v("the second one is the name of the resource type (i.e. usually the service) you're setting it on,")]),t._v(" "),s("li",[t._v("the third one is the conditions to further restrict which resources the permission applies to.")])]),t._v(" "),t._m(37),t._v(" "),t._m(38),t._v(" "),t._m(39),s("p",[t._v("You will find implementation details "),s("a",{attrs:{href:"https://blog.feathersjs.com/access-control-strategies-with-feathersjs-72452268739d",target:"_blank",rel:"noopener noreferrer"}},[t._v("in this article"),s("OutboundLink")],1),t._v(".")]),t._v(" "),t._m(40),t._v(" "),t._m(41),t._v(" "),s("p",[t._v("We use the "),s("a",{attrs:{href:"https://alligator.io/vuejs/global-event-bus/",target:"_blank",rel:"noopener noreferrer"}},[t._v("global event bus"),s("OutboundLink")],1),t._v(" provided by Quasar to exchange events between independent components in the app:")]),t._v(" "),t._m(42),t._m(43),t._v(" "),t._m(44),t._v(" "),t._m(45),t._v(" "),t._m(46),t._m(47),t._v(" "),t._m(48),t._v(" "),t._m(49),t._v(" "),t._m(50),t._v(" "),s("p",[t._v("Internationalization relies on "),s("a",{attrs:{href:"https://github.com/i18next/i18next",target:"_blank",rel:"noopener noreferrer"}},[t._v("i18next"),s("OutboundLink")],1),t._v(" and its "),s("a",{attrs:{href:"https://github.com/panter/vue-i18next",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue plugin"),s("OutboundLink")],1),t._v(". We don't use "),s("a",{attrs:{href:"https://panter.github.io/vue-i18next/guide/component.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("component based localization"),s("OutboundLink")],1),t._v(" and prefer to use "),s("a",{attrs:{href:"https://panter.github.io/vue-i18next/guide/component-interpolation.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("component interpolation"),s("OutboundLink")],1),t._v(". Each module/application has its own set of translation files stored in the "),s("em",[t._v("client/i18n")]),t._v(" folder. To avoid conflicts the convention we use is the following:")]),t._v(" "),t._m(51),t._v(" "),t._m(52),s("p",[t._v("The setup of your application simply consists in providing to the i18n system the resolvers to load all the required translation files, please refer to our "),s("a",{attrs:{href:"https://github.com/kalisio/kApp/blob/master/src/i18n/index.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("application template"),s("OutboundLink")],1),t._v(".")]),t._v(" "),t._m(53),t._v(" "),s("p",[t._v("Usually translations are only meant to be used at the client level, server errors are converted to client-side translation based on error codes. However, sometimes you need to raise more specific and meaningful error messages from the server, in this case the raised error should contain translation key(s) and context instead of raw message(s), e.g.:")]),t._v(" "),t._m(54),s("p",[t._v("That way you can generate client-side translation with a generic error handler like in our "),s("a",{attrs:{href:"https://github.com/kalisio/kApp/blob/master/src/App.vue",target:"_blank",rel:"noopener noreferrer"}},[t._v("application template"),s("OutboundLink")],1),t._v(":")]),t._v(" "),t._m(55)])},a,!1,null,null,null);r.options.__file="application.md";e.default=r.exports}}]);