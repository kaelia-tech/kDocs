(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{426:function(e,t,r){"use strict";r.r(t);var o=r(27),s=Object(o.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"configure-your-app"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#configure-your-app"}},[e._v("#")]),e._v(" Configure your app")]),e._v(" "),r("h2",{attrs:{id:"configure-application"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#configure-application"}},[e._v("#")]),e._v(" Configure application")]),e._v(" "),r("p",[e._v("Depending on the third-party services you need you will have to do the following:")]),e._v(" "),r("ul",[r("li",[e._v("Generate a secret to secure your authentication, use one generated by the Feathers CLI")]),e._v(" "),r("li",[e._v("Create a Firebase app in the "),r("a",{attrs:{href:"https://console.firebase.google.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("Firebase Console"),r("OutboundLink")],1),e._v(" "),r("ul",[r("li",[e._v("retrieve the "),r("code",[e._v("google-services.json")]),e._v(" to be stored as a secret file in the "),r("em",[e._v("cordova")]),e._v(" directory")]),e._v(" "),r("li",[e._v("create an Android app in your Firebase app and keep track of secret server key in "),r("em",[e._v("Parameters > Cloud Messaging")])])])]),e._v(" "),r("li",[e._v("Create a GCM application in the "),r("a",{attrs:{href:"https://eu-west-1.console.aws.amazon.com/sns/v2/home",target:"_blank",rel:"noopener noreferrer"}},[e._v("AWS SNS console"),r("OutboundLink")],1),e._v(" using the previous server key\n"),r("ul",[r("li",[e._v("keep track of app ARN")])])]),e._v(" "),r("li",[e._v("Create a new project for your app in the "),r("a",{attrs:{href:"https://console.cloud.google.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("Google Cloud Console"),r("OutboundLink")],1),e._v(" "),r("ul",[r("li",[e._v("Activate the Google+ API on your project")])])]),e._v(" "),r("li",[e._v("Create an OAuth2 ID for a Web App in "),r("a",{attrs:{href:"https://console.cloud.google.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("Google Cloud Console"),r("OutboundLink")],1),e._v(" > "),r("em",[e._v("API & services")]),e._v(" "),r("ul",[r("li",[e._v("the redirect URL should match "),r("em",[e._v("your.domain/auth/google/callback")])]),e._v(" "),r("li",[e._v("download the "),r("em",[e._v("json")]),e._v(" dans keep track of client ID and secret")])])]),e._v(" "),r("li",[e._v("Create an OAuth2 App in "),r("a",{attrs:{href:"https://github.com/organizations/kalisio/settings/applications",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitHub"),r("OutboundLink")],1),e._v(" "),r("ul",[r("li",[e._v("the redirect URL should match "),r("em",[e._v("your.domain/auth/github/callback")])]),e._v(" "),r("li",[e._v("download the "),r("em",[e._v("json")]),e._v(" dans keep track of client ID and secret")])])]),e._v(" "),r("li",[e._v("Create an AWS user in "),r("a",{attrs:{href:"https://console.aws.amazon.com/iam/home",target:"_blank",rel:"noopener noreferrer"}},[e._v("IAM"),r("OutboundLink")],1),e._v(" with access to S3 API (e.g. "),r("em",[e._v("AmazonS3FullAccess")]),e._v(")\n"),r("ul",[r("li",[e._v("keep track of access key ID and secret")])])]),e._v(" "),r("li",[e._v("Create a bucket for your app in the Kalisio account\n"),r("ul",[r("li",[e._v("keep track of its name")])])]),e._v(" "),r("li",[e._v("Create an AWS user in "),r("a",{attrs:{href:"https://console.aws.amazon.com/iam/home",target:"_blank",rel:"noopener noreferrer"}},[e._v("IAM"),r("OutboundLink")],1),e._v(" with access to SNS API (e.g. "),r("em",[e._v("AmazonSNSFullAccess")]),e._v(")\n"),r("ul",[r("li",[e._v("keep track of access key ID and secret")])])])]),e._v(" "),r("div",{staticClass:"custom-block tip"},[r("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),r("p",[e._v("Note: some of the previous accounts/IDs are not app specific and can be share accross multiple apps, e.g. S3, SNS, etc.")])]),e._v(" "),r("p",[e._v("Create required environment variables in a script file you can source before launching your app:")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("export APP_SECRET=xxx\nexport GOOGLE_MAIL_USER=xxx\nexport GOOGLE_MAIL_PASSWORD=xxx\nexport SNS_ACCESS_KEY=xxx\nexport SNS_SECRET_ACCESS_KEY=xxx\nexport SNS_ANDROID_ARN=xxx\nexport S3_ACCESS_KEY=xxx\nexport S3_SECRET_ACCESS_KEY=xxx\nexport S3_BUCKET=xxx\nexport GITHUB_CLIENT_ID=xxx\nexport GITHUB_CLIENT_SECRET=xxx\nexport GOOGLE_CLIENT_ID=xxx\nexport GOOGLE_CLIENT_SECRET=xxx\n")])])]),r("p",[e._v("Then, retrieve this variables in config files like this:")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("github: {\n  clientID: process.env.GITHUB_CLIENT_ID,\n  clientSecret: process.env.GITHUB_CLIENT_SECRET\n}\n")])])]),r("p",[e._v("In your local development environment you should use the script to setup all the required secrets. This script should be safe-guarded in a non-public environment.")]),e._v(" "),r("div",{staticClass:"custom-block danger"},[r("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),r("p",[e._v("You should never store production passwords or other sensitive production data in a clear form in public source code or config files.")])]),e._v(" "),r("p",[e._v("During the "),r("RouterLink",{attrs:{to:"/guides/development/deploy.html"}},[e._v("CI/CD process")]),e._v(" the script "),r("em",[e._v("travis.env.sh")]),e._v(" automatically generates a temporary environment file, based on the secret environment variables defined in your Travis repository settings or coming from a dedicated private repository (in this case only the access token of this repository needs to be in your Travis settings), to be sourced at the different stages.")],1),e._v(" "),r("div",{staticClass:"custom-block warning"},[r("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),r("p",[e._v("You shouldn't use production secrets in development and test mode.")])]),e._v(" "),r("p",[e._v("To avoid publishing by error production secrets we recommand generating an access key/token for each flavor "),r("em",[e._v("AND")]),e._v(" third-party service required by your app using the following naming convention for these tokens: "),r("strong",[e._v("flavor-service")]),e._v(". For instance you would have a "),r("strong",[e._v("dev-s3")]),e._v(", "),r("strong",[e._v("test-s3")]),e._v(" and "),r("strong",[e._v("prod-s3")]),e._v(" keys to use the AWS S3 service respectively in your dev, test and production version of your app.")]),e._v(" "),r("h2",{attrs:{id:"configure-ci-cd"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#configure-ci-cd"}},[e._v("#")]),e._v(" Configure CI/CD")]),e._v(" "),r("p",[e._v("As the application and the CI/CD build relies on third-party services its configuration must include secrets like API keys, passwords, etc. and "),r("strong",[e._v("should not be pushed under source control unless you use private repositories or encryption")]),e._v(". The "),r("RouterLink",{attrs:{to:"/guides/development/deploy.html"}},[e._v("CI/CD section")]),e._v(" explains how we manage it efficiently in a secure way but this section details some basic mechanisms you can use if you need to store some CI/CD specific data securely.")],1),e._v(" "),r("h3",{attrs:{id:"secret-variables"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#secret-variables"}},[e._v("#")]),e._v(" Secret variables")]),e._v(" "),r("p",[e._v("If some of the sensitive data are stored using environment variables, you have to use "),r("a",{attrs:{href:"https://docs.travis-ci.com/user/environment-variables/",target:"_blank",rel:"noopener noreferrer"}},[e._v("encrypted environment variables"),r("OutboundLink")],1),e._v(" set either in build file or repository settings.")]),e._v(" "),r("div",{staticClass:"custom-block warning"},[r("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),r("p",[e._v("If you'd like to set a value holding multilines or special characters take care to surround it with "),r("code",[e._v('"')]),e._v(" so that it will be properly escaped.")])]),e._v(" "),r("h3",{attrs:{id:"secret-file"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#secret-file"}},[e._v("#")]),e._v(" Secret file")]),e._v(" "),r("p",[e._v("If you need additional sensitive data stored through "),r("a",{attrs:{href:"https://docs.travis-ci.com/user/encrypting-files/",target:"_blank",rel:"noopener noreferrer"}},[e._v("files"),r("OutboundLink")],1),e._v(" create a "),r("em",[e._v("secrets.tar")]),e._v(" containing all secured files and encode it to "),r("em",[e._v("secrets.tar.enc")]),e._v(" a using "),r("RouterLink",{attrs:{to:"/tools/cli.html#travis-cli"}},[e._v("Travis CLI")]),e._v(". This file will be decrypted before the build or whenever you need something inside.")],1),e._v(" "),r("p",[e._v("Indeed, as mentioned in the "),r("a",{attrs:{href:"https://docs.travis-ci.com/user/encrypting-files/#Encrypting-multiple-files",target:"_blank",rel:"noopener noreferrer"}},[e._v("documentation"),r("OutboundLink")],1),e._v(", it is not possible to encrypt multiple files and thus requires to create a "),r("code",[e._v("tar")]),e._v(" file containing the different secret files and encrypts the archive.")]),e._v(" "),r("p",[e._v("The table below lists for example the required files to publish a mobile app using Cordova:")]),e._v(" "),r("table",[r("thead",[r("tr",[r("th",{staticStyle:{"text-align":"left"}},[e._v("File")]),e._v(" "),r("th",{staticStyle:{"text-align":"left"}},[e._v("Description")])])]),e._v(" "),r("tbody",[r("tr",[r("td",{staticStyle:{"text-align":"left"}},[e._v("keystore file")]),e._v(" "),r("td",{staticStyle:{"text-align":"left"}},[e._v("A binary file containing the private key of the certificate you need to sign the Android app")])]),e._v(" "),r("tr",[r("td",{staticStyle:{"text-align":"left"}},[e._v("cordova build file")]),e._v(" "),r("td",{staticStyle:{"text-align":"left"}},[e._v("A Json file used by Cordova to sign the generated application. It uses the keystore file")])]),e._v(" "),r("tr",[r("td",{staticStyle:{"text-align":"left"}},[e._v("google play service account")]),e._v(" "),r("td",{staticStyle:{"text-align":"left"}},[e._v("A Json file storing the data needed to use the Google Play service account")])]),e._v(" "),r("tr",[r("td",{staticStyle:{"text-align":"left"}},[e._v("google services account")]),e._v(" "),r("td",{staticStyle:{"text-align":"left"}},[e._v("A Json file storing the the keys to access the various Google services")])])])]),e._v(" "),r("p",[e._v("You need to be logged into Travis CI before generating the secret file like this:")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("tar cvf secrets.tar your_keystore.keystore build.json google-play.json google-services.json\ntravis encrypt-file secrets.tar\n")])])])])}),[],!1,null,null,null);t.default=s.exports}}]);